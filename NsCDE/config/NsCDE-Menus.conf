#
# This file is a part of the NsCDE - Not so Common Desktop Environment
# Author: Hegel3DReloaded
# Licence: GPLv3
#

# Root Menu
DestroyMenu MenuFvwmRoot
AddToMenu MenuFvwmRoot "Workspace Menu" Title
+ "" Nop
+ "" Nop
Test (!EnvMatch infostore.sandboxmode 1) + "Applications" Popup m_Applications
+ "Quick Menu" Popup m_QuickMenu
Test (!EnvMatch infostore.sandboxmode 1) + "NsCDE Help" Popup m_NsCDEHelpMenu
+ "" Nop
+ "E&xecute ..." f_ToggleFvwmFunc ExecDialog Close f_RunQuickScriptDialog ExecDialog
Test (x $[infostore.terminal]) + "&Terminal" Exec exec $[infostore.terminal]
Test (x $[infostore.filemgr]) + "&File Manager" Exec exec $[infostore.filemgr]
Test (x $[infostore.xeditor]) + "&Editor" Exec exec $[infostore.xeditor]
+ "" Nop
f_AddCustomToRootMenu
+ "" Nop
+ "Windows ..." Popup m_WindowOpsRootWin
+ "Re&fresh all Windows" Refresh
+ "Rearrange Desk &Icons" All (CurrentDesk, Iconic) PlaceAgain Icon
+ "" Nop
+ "Minimize/Restore Front Panel" f_RestoreFrontPanel WindowShade South
+ "Restart Workspace Manager" KillModule FvwmScript WSM
+ "" Nop
+ "&Lock Screen" f_Xscreensaver -lock
+ "&Restart NsCDE ..." f_RunQuickScriptDialog ActionForm "Restart NsCDE?" Yes No "Restart NsCDE" Restart Nop
Piperead '(pm-is-supported --suspend || false) && \
          echo "Test (EnvMatch infostore.sandboxmode 0) \
          + \\"&Suspend System ...\\" f_RunQuickScriptDialog SysActionDialog 6"'
Test (EnvMatch infostore.sandboxmode 0) + "&Quit ..." f_RunQuickScriptDialog SysActionDialog
Test (EnvMatch infostore.sandboxmode 1) + "&Quit" Quit

# Applications Menu
DestroyMenu m_Applications
AddToMenu m_Applications "Applications" Title
+ "NsCDE%NsCDE/Dtagen.xpm%" Popup m_NsCDEMenu
Test (!EnvMatch infostore.sandboxmode 1) f_ApplicationsMenu

# Quick Menu
DestroyMenu m_QuickMenu
AddToMenu m_QuickMenu "Quick Menu" Title

# Help Menu
DestroyMenu m_NsCDEHelpMenu
AddToMenu m_NsCDEHelpMenu "NsCDE Help" Title
+ "Using Menus%CDE/SDtF.prop.t.pm%" \
 f_DisplayURL "Menus Help" $[NSCDE_ROOT]/share/doc/html/NsCDE-Menus_conf.html
+ "GUI Tools%CDE/SDtF.prop.t.pm%" \
 f_DisplayURL "GUI Tools Help" $[NSCDE_ROOT]/share/doc/html/NsCDE-GUI-Tools.html
+ "Backdrops Palettes Fonts%CDE/SDtF.prop.t.pm%" \
 f_DisplayURL "Backdrops Palettes and Fonts Help" $[NSCDE_ROOT]/share/doc/html/NsCDE-Backdrops-Palettes-Fonts.html
+ "Default Key Bindings%CDE/SDtF.prop.t.pm%" \
 f_DisplayURL "Key Bindings Help" $[NSCDE_ROOT]/share/doc/html/NsCDE-Keybindings_conf.html
+ "Default Mouse Bindings%CDE/SDtF.prop.t.pm%" \
 f_DisplayURL "Mouse Bindings Help" $[NSCDE_ROOT]/share/doc/html/NsCDE-Mousebindings_conf.html
+ "" Nop
+ "NsCDE Components%CDE/DtRdMe.t.pm%" \
 f_DisplayURL "NsCDE Components" $[NSCDE_ROOT]/share/doc/html/NsCDE-components.html
+ "Configuration Files%CDE/DtRdMe.t.pm%" \
 f_DisplayURL "NsCDE Configuration Files" $[NSCDE_ROOT]/share/doc/html/NsCDE-Configuration-Files.html
+ "Integration X, Gtk, Qt ...%CDE/DtRdMe.t.pm%" \
 f_DisplayURL "NsCDE X Integrations" $[NSCDE_ROOT]/share/doc/html/NsCDE-Integrations.html
+ "" Nop
Test (x xdg-open) + "All Documentation (pdf)%NsCDE/Fphelp.t.pm%" \
 Exec exec xdg-open $[NSCDE_ROOT]/share/doc/NsCDE.pdf
+ "All Documentation (html)%NsCDE/Fphelp.t.pm%" \
 f_DisplayURL "NsCDE Documentation" $[NSCDE_ROOT]/share/doc/html/index.html

# NsCDE Menu
DestroyMenu m_NsCDEMenu
AddToMenu m_NsCDEMenu
+ "&Style Manager%CDE/Dtstyle.t.pm%" f_ToggleFvwmModule FvwmScript StyleMgr
+ "&Exec%CDE/Dtexec.t.pm%" f_ToggleFvwmFunc ExecDialog Close f_RunQuickScriptDialog ExecDialog
+ "&Workstation Info%CDE/SDtsysinfo.t.pm%" f_ToggleFvwmModule FvwmScript Sysinfo
+ "Workspaces and &Pages%CDE/Dtfpcfg.t.pm%" f_ToggleFvwmFunc WsPgMgr Close f_RunQuickScriptDialog WsPgMgr $[infostore.desknum] $[infostore.pagematrixX] $[infostore.pagematrixY]
+ "&NsCDE Log%CDE/SDtErrors.t.pm%" f_ToggleExecWindow WatchWinMgrErrors UrgencyFunc xterm -title \"Watch Errors\" -name WatchWinMgrErrors -e tail -300f ~/.xsession-errors
+ "&Fvwm Diagnostic Console%NsCDE/FvwmCons.t.xpm%" Module FvwmConsole -title "FVWM Diagnostic Console" -geometry 92x22

DestroyMenu m_MoveToPage
AddToMenu m_MoveToPage
f_MoveToPage

DestroyMenu m_MoveToWorkspace
AddToMenu m_MoveToWorkspace
f_MoveToWorkspace

DestroyMenu m_GoToPage
AddToMenu m_GoToPage "Go to Page ..." Title
+ DynamicPopupAction Function f_FrontPanelAction FpPGM M1 30
f_GoToPage

DestroyMenu m_TitleBarM2
AddToMenu m_TitleBarM2
+ "Identify Window" Module FvwmIdent
+ "X Window Info" f_XwinInfo
+ "X Window Property Display" f_Xprop
+ "Screenshot (With WM decorations)" f_ScreenShot -frame
+ "Screenshot (Without WM decorations)" f_ScreenShot

DestroyMenu m_IconM2
AddToMenu m_IconM2
+ "Identify" Module FvwmIdent
+ "X Win Info" f_XwinInfo
+ "X Property Display" f_Xprop

DestroyMenu m_IconOps
AddToMenu m_IconOps
+ "De&iconify		$[infostore.km_iconify]" Iconify Off
+ "Deiconify On Page ..." Popup m_DeiconifyOnPage
+ "" Nop
+ "&Move		$[infostore.km_move]" Move
+ "&Lower		$[infostore.km_raiselower]" Lower
+ "Rai&se		$[infostore.km_raiselower]" Raise
+ "" Nop
+ "&Occupy Workspace...		$[infostore.km_occupyworkspace]" None (OccupyWorkspace) Current f_SendToOccupy
+ "Occupy &All Workspaces" Stick True
+ "&Unoccupy Workspaces" Stick False
+ "" Nop
+ "&Delete		$[infostore.km_delete]" Delete
+ "&Close		$[infostore.km_close]" Close
+ "Destroy		$[infostore.km_destroy]" Destroy

DestroyMenu m_DeiconifyOnPage
AddToMenu m_DeiconifyOnPage
f_DeiconifyOnPageMenu

DestroyMenu m_WindowOps
AddToMenu m_WindowOps
f_WindowOps m_WindowOps
+ "More ..." Menu m_WindowOpsMore This 0 0
f_WindowOpsBottom m_WindowOps
+ "" Nop
f_WindowOpsGeometry m_WindowOps

DestroyMenu m_SubpanelWindowOps
AddToMenu m_SubpanelWindowOps
f_WindowOps m_SubpanelWindowOps
+ "Refresh Subpanel" Current f_RefreshSubpanel $[w.resource]
+ "Subpanel Settings" Current Module FvwmScript SubpanelSettings $[w.resource]

DestroyMenu m_WindowOpsMore
AddToMenu m_WindowOpsMore
f_WindowOps m_WindowOpsMore
+ "Less ..." Menu m_WindowOps This 0 0
+ "" Nop
f_WindowOpsMore m_WindowOpsMore
f_WindowOpsBottom m_WindowOpsMore
+ "" Nop
f_WindowOpsGeometry m_WindowOpsMore

DestroyMenu m_WindowOpsRootWin
AddToMenu m_WindowOpsRootWin "Window Options" Title
f_WindowOps m_WindowOpsRootWin
f_WindowOpsMore m_WindowOpsRootWin
+ "Screenshot (3s delay)		$[infostore.km_rootscreenshot]" f_RootScreenShot 3000
f_WindowOpsBottom m_WindowOpsRootWin

DestroyMenu m_WindowLayers
AddToMenu m_WindowLayers "Window Layers" Title
+ "Stays on Layer Top" Pick (CirculateHit) Layer 0 6
+ "Stays on Layer Put" Pick (CirculateHit) Layer 0 4
+ "Stays on Layer Bottom" Pick (CirculateHit) Layer 0 2

DestroyMenu m_WindowOpsXterm
AddToMenu m_WindowOpsXterm
f_WindowOps m_WindowOpsXterm
+ "More ..." Menu m_WindowOpsMore This 0 0
f_WindowOpsBottom m_WindowOpsXterm
+ "" Nop
f_WindowOpsGeometry m_WindowOpsXterm
+ "" Nop
+ "Wide Terminal		$[infostore.km_wideterm_static]" f_WideTerm

DestroyMenu m_WindowOpsWatchWinMgrErrors
AddToMenu m_WindowOpsWatchWinMgrErrors
f_WindowOps m_WindowOpsWatchWinMgrErrors
+ "More ..." Menu m_WindowOpsMore This 0 0
f_WindowOpsBottom m_WindowOpsWatchWinMgrErrors
+ "" Nop
f_WindowOpsGeometry m_WindowOpsWatchWinMgrErrors
+ "" Nop
+ "Fvwm Diagnostic Console"		Module FvwmConsole -title "FVWM Diagnostic Console" -geometry 92x22

DestroyMenu m_FrontPanelWinMenu
AddToMenu m_FrontPanelWinMenu
f_WindowOpsFP m_FrontPanelWinMenu

DestroyMenu m_ControlFrontPanelMenu
AddToMenu m_ControlFrontPanelMenu "Front Panel Controls" Title
+ "Manage Workspaces and Pages" f_ToggleFvwmFunc WsPgMgr Close f_RunQuickScriptDialog WsPgMgr $[infostore.desknum] $[infostore.pagematrixX] $[infostore.pagematrixY]
+ "Restart WorkSpace Manager" KillModule FvwmScript WSM
+ "Restart Front Panel Clock" Exec exec pkill -U $LOGNAME pclock
+ "Restart Front Panel Mail" KillModule FvwmScript CheckMailApplet
+ "Restart Front Panel Date" KillModule FvwmScript MonthDayApplet
+ "Restart Front Panel Lite" KillModule FvwmScript FpLite
+ "Restart Front Panel" f_RestartFrontPanel

DestroyMenu m_FrontPanelLockMenu
AddToMenu m_FrontPanelLockMenu
AddToMenu m_FrontPanelLockMenu " Lock " Title
+ "&Lock Display" Test (x xscreensaver) f_Xscreensaver -lock
+ "&Suspend Locking" Test (x xscreensaver) f_Xscreensaver -stop
+ "&Resume Locking" Test (x xscreensaver) f_Xscreensaver -cont
+ "" Nop
+ "&Help" Exec exec $[infostore.terminal] -e "man xscreensaver"

DestroyMenu m_FrontPanelLiteMenu
AddToMenu m_FrontPanelLiteMenu
AddToMenu m_FrontPanelLiteMenu " Busy " Title
+ "&Details" f_FpLiteClickAction
+ "&Help" f_DisplayURL "Lite Help" $[NSCDE_ROOT]/share/doc/html/NsCDE-FpLite.html

DestroyMenu m_FrontPanelExitMenu
AddToMenu m_FrontPanelExitMenu
AddToMenu m_FrontPanelExitMenu " Exit " Title
+ "&ExitSession" f_RunQuickScriptDialog SysActionDialog
+ "" Nop
+ "&Help" f_DisplayURL "Exit Help" $[NSCDE_ROOT]/share/doc/html/NsCDE-SysActionDialog.html

DestroyMenu m_FrontPanelPGMMenu
AddToMenu m_FrontPanelPGMMenu
AddToMenu m_FrontPanelPGMMenu " Pages " Title
+ "&Pages Menu" SendToModule FrontPanel PressButton FpPGM
+ "&Visual Pager" f_MoveCursorAndExec 0 -14 f_ShowLocalPager AnimatedMove m-5 m-6
+ "" Nop
+ "&Help" f_DisplayURL "PGM Help" $[NSCDE_ROOT]/share/doc/html/NsCDE-PGM.html

# Apply menu styles to menus.
ChangeMenuStyle WorkspaceMenu MenuFvwmRoot

ChangeMenuStyle MainSmallMenu m_IconOps m_IconM2 m_ControlFrontPanelMenu \
                m_WindowOpsRootWin m_SubpanelWindowOps m_WindowOps \
                m_WindowOpsWatchWinMgrErrors m_WindowOpsXterm m_TitleBarM2

ChangeMenuStyle SmallMenu m_DeiconifyOnPage m_WindowLayers

ChangeMenuStyle CommonMenu m_WindowOps m_WindowOpsMore m_FrontPanelWinMenu m_TitleBarM2

ChangeMenuStyle CommonAppMenu m_FrontPanelLockMenu m_FrontPanelLiteMenu \
                m_FrontPanelExitMenu m_FrontPanelPGMMenu

ChangeMenuStyle PGMAppMenu m_GoToPage

